angular.module("fluro.audio",["fluro.config","fluro.util"]),angular.module("fluro.audio").directive("fluroAudio",function($compile,Fluro){return{restrict:"E",replace:!0,template:'<div class="fluro-audio audio-{{model.assetType}}"></div>',controller:"FluroAudioController",scope:{model:"=ngModel",ngParams:"&"},link:function($scope,$element){$scope.$watch("model",function(){$scope.params=$scope.ngParams(),$scope.params||($scope.params={controls:0,autoplay:0,modestbranding:1,playsinline:1,showinfo:0,theme:"light",byline:0,portrait:0,title:0});var template;switch($element.empty(),$scope.model.assetType){case"soundcloud":template='<div class="audio-embed"><soundcloud-audio track-url="model.external.soundcloud" player-vars="params"/></div>';break;case"upload":$scope.playUrl=Fluro.apiURL+"/get/"+$scope.model._id,template='<div class="audio-embed"><audio controls><source ng-src="{{playUrl | trustfluro}}" type="{{model.mimetype}}"></audio></div>'}if(template){var cTemplate=$compile(template)($scope);$element.append(cTemplate)}})}}}).filter("trustfluro",["$sce",function($sce){return function(val){return $sce.trustAsResourceUrl(val)}}]).controller("FluroAudioController",function(){}).service("AudioTools",function(){var controller={};return controller}),angular.module("fluro.audio").service("SoundcloudEmbedSettings",function(){var controller={};return controller}).directive("soundcloudAudio",function($compile){return{restrict:"E",scope:{trackUrl:"=",playerVars:"="},link:function($scope,$element){$scope.$watch("trackUrl + playerVars",function(){var params="";if($scope.playerVars)for(var key in $scope.playerVars)params+="&"+key+"="+$scope.playerVars[key];$scope.soundcloudEmbedUrl="https://w.soundcloud.com/player/?url="+$scope.trackUrl+"&"+serialize($scope.playerVars)});var template='<iframe width="100%" height="600" scrolling="no" frameborder="no" ng-src="{{soundcloudEmbedUrl}}"></iframe>',cTemplate=$compile(template)($scope);$element.replaceWith(cTemplate)}}}).filter("trustSoundcloud",["$sce",function($sce){return function(val){return $sce.trustAsResourceUrl(val)}}]);